if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((s=>t.resolve(e()).then((()=>s))),(s=>t.resolve(e()).then((()=>{throw s}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";const t="auth_user",s="auth_token",a="auth_expires",i="user:";function n(){try{const e=uni.getStorageSync(t),i=uni.getStorageSync(s),n=uni.getStorageSync(a);return e&&i&&n?Date.now()>Number(n)?(o(),null):{user:e,token:i,expiresAt:Number(n)}:null}catch(e){return null}}function o(){try{uni.removeStorageSync(t),uni.removeStorageSync(s),uni.removeStorageSync(a)}catch(e){}}async function r(e,n){{const o=uni.getStorageSync(i+e);if(o&&o.password===n){const i={id:Date.now(),name:e};return function({user:e,token:i="mock-token",ttlMs:n=6048e5}){const o=Date.now();try{uni.setStorageSync(t,e),uni.setStorageSync(s,i),uni.setStorageSync(a,o+n)}catch(r){}}({user:i}),{ok:!0,token:"mock-token",user:i}}throw new Error("è´¦å·æˆ–å¯†ç é”™è¯¯")}}function c(){const e=n();return e?e.user:null}const l=(e,t)=>{const s=e.__vccOpts||e;for(const[a,i]of t)s[a]=i;return s};const h=l({data:()=>({name:"",password:"",loading:!1,error:""}),mounted(){c()&&uni.switchTab({url:"/pages/swimming/index"})},methods:{async doLogin(){if(this.error="",this.name&&this.password){this.loading=!0;try{await r(this.name,this.password),uni.switchTab({url:"/pages/swimming/index"})}catch(e){this.error=e.message||"ç™»å½•å¤±è´¥"}finally{this.loading=!1}}else this.error="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç "},goRegister(){uni.navigateTo({url:"/pages/auth/register"})}}},[["render",function(t,s,a,i,n,o){return e.openBlock(),e.createElementBlock("view",{class:"auth-page"},[e.createElementVNode("view",{class:"card"},[e.createElementVNode("text",{class:"title"},"ç™»å½•"),e.withDirectives(e.createElementVNode("input",{class:"ipt","onUpdate:modelValue":s[0]||(s[0]=e=>n.name=e),placeholder:"ç”¨æˆ·å"},null,512),[[e.vModelText,n.name]]),e.withDirectives(e.createElementVNode("input",{class:"ipt","onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e),placeholder:"å¯†ç ",password:""},null,512),[[e.vModelText,n.password]]),e.createElementVNode("button",{class:"btn primary",disabled:n.loading,onClick:s[2]||(s[2]=(...e)=>o.doLogin&&o.doLogin(...e))},e.toDisplayString(n.loading?"ç™»å½•ä¸­...":"ç™»å½•"),9,["disabled"]),e.createElementVNode("button",{class:"btn",onClick:s[3]||(s[3]=(...e)=>o.goRegister&&o.goRegister(...e))},"å»æ³¨å†Œ"),n.error?(e.openBlock(),e.createElementBlock("text",{key:0,class:"err"},e.toDisplayString(n.error),1)):e.createCommentVNode("",!0)])])}],["__scopeId","data-v-04683ee2"]]);const m=l({data:()=>({name:"",password:"",loading:!1,error:"",ok:!1}),methods:{async doRegister(){if(this.error="",this.ok=!1,this.name&&this.password){this.loading=!0;try{await async function(e,t){if(!e||!t)throw new Error("è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ");if(uni.getStorageSync(i+e))throw new Error("ç”¨æˆ·åå·²å­˜åœ¨");return uni.setStorageSync(i+e,{name:e,password:t}),{ok:!0,user:{id:Date.now(),name:e}}}(this.name,this.password),this.ok=!0,setTimeout((()=>uni.redirectTo({url:"/pages/auth/login"})),800)}catch(e){this.error=e.message||"æ³¨å†Œå¤±è´¥"}finally{this.loading=!1}}else this.error="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç "},goLogin(){uni.navigateTo({url:"/pages/auth/login"})}}},[["render",function(t,s,a,i,n,o){return e.openBlock(),e.createElementBlock("view",{class:"auth-page"},[e.createElementVNode("view",{class:"card"},[e.createElementVNode("text",{class:"title"},"æ³¨å†Œ"),e.withDirectives(e.createElementVNode("input",{class:"ipt","onUpdate:modelValue":s[0]||(s[0]=e=>n.name=e),placeholder:"ç”¨æˆ·å"},null,512),[[e.vModelText,n.name]]),e.withDirectives(e.createElementVNode("input",{class:"ipt","onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e),placeholder:"å¯†ç ",password:""},null,512),[[e.vModelText,n.password]]),e.createElementVNode("button",{class:"btn primary",disabled:n.loading,onClick:s[2]||(s[2]=(...e)=>o.doRegister&&o.doRegister(...e))},e.toDisplayString(n.loading?"æ³¨å†Œä¸­...":"æ³¨å†Œ"),9,["disabled"]),e.createElementVNode("button",{class:"btn",onClick:s[3]||(s[3]=(...e)=>o.goLogin&&o.goLogin(...e))},"è¿”å›ç™»å½•"),n.error?(e.openBlock(),e.createElementBlock("text",{key:0,class:"err"},e.toDisplayString(n.error),1)):e.createCommentVNode("",!0),n.ok?(e.openBlock(),e.createElementBlock("text",{key:1,class:"ok"},"æ³¨å†ŒæˆåŠŸï¼Œå·²è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°ï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰")):e.createCommentVNode("",!0)])])}],["__scopeId","data-v-ead3f804"]]);function u(e,t,...s){uni.__log__?uni.__log__(e,t,...s):console[e].apply(console,[...s,t])}class d{constructor(){this.isListening=!1,this.isInitialized=!1,this.support={motion:!1,orientation:!1},this.permissionTried=!1,this.permissionGranted=!1,this.callbacks={motion:null,orientation:null,error:null},this.sensorData={acceleration:{x:0,y:0,z:0},rotationRate:{alpha:0,beta:0,gamma:0},orientation:{alpha:0,beta:0,gamma:0}},this.strokeConfig={threshold:1.2,cooldown:500,minPower:.5,maxPower:2,smoothing:.8},this.strokeState={lastTime:0,lastPower:0,combo:0,smoothedAccel:0,smoothedRotation:0},this._handleMotion=this._handleMotion.bind(this),this._handleOrientation=this._handleOrientation.bind(this),this._handleError=this._handleError.bind(this)}async initialize(){if(!this.isInitialized){if(!this._checkSensorSupport())throw new Error("è®¾å¤‡ä¸æ”¯æŒä¼ æ„Ÿå™¨æˆ–æµè§ˆå™¨å·²ç¦ç”¨");try{await this._requestPermission(),this.isInitialized=!0,u("log","at common/sensorManager.js:68","ä¼ æ„Ÿå™¨åˆå§‹åŒ–æˆåŠŸ")}catch(e){throw u("error","at common/sensorManager.js:70","ä¼ æ„Ÿå™¨åˆå§‹åŒ–å¤±è´¥:",e),e}}}startListening(){if(!this.isInitialized)throw new Error("ä¼ æ„Ÿå™¨æœªåˆå§‹åŒ–");if(!this.isListening)try{window.DeviceMotionEvent&&window.addEventListener("devicemotion",this._handleMotion),window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",this._handleOrientation),this.isListening=!0,u("log","at common/sensorManager.js:99","å¼€å§‹ç›‘å¬ä¼ æ„Ÿå™¨æ•°æ®")}catch(e){throw this._handleError(e),e}}stopListening(){this.isListening&&(window.removeEventListener("devicemotion",this._handleMotion),window.removeEventListener("deviceorientation",this._handleOrientation),this.isListening=!1,u("log","at common/sensorManager.js:118","åœæ­¢ç›‘å¬ä¼ æ„Ÿå™¨æ•°æ®"))}_checkSensorSupport(){const e=plus.accelerometer,t=plus.compass;return!(!e||!t)}async _requestPermission(){try{await new Promise(((e,t)=>{plus.accelerometer.watchAcceleration((()=>e()),(e=>t(new Error("åŠ é€Ÿåº¦ä¼ æ„Ÿå™¨åˆå§‹åŒ–å¤±è´¥: "+e.message))),{frequency:50})})),await new Promise(((e,t)=>{plus.compass.watchHeading((()=>e()),(e=>t(new Error("æ–¹å‘ä¼ æ„Ÿå™¨åˆå§‹åŒ–å¤±è´¥: "+e.message))),{frequency:50})}))}catch(e){throw new Error("è¯·æ±‚ä¼ æ„Ÿå™¨æƒé™å¤±è´¥: "+e.message)}}_handleMotion(e){e&&e.acceleration&&e.rotationRate&&(this.sensorData.acceleration={x:e.acceleration.x||0,y:e.acceleration.y||0,z:e.acceleration.z||0},this.sensorData.rotationRate={alpha:e.rotationRate.alpha||0,beta:e.rotationRate.beta||0,gamma:e.rotationRate.gamma||0},this._detectSwimmingStroke(),this.callbacks.motion&&this.callbacks.motion(this.sensorData))}_handleOrientation(e){e&&(this.sensorData.orientation={alpha:e.alpha||0,beta:e.beta||0,gamma:e.gamma||0},this.callbacks.orientation&&this.callbacks.orientation(this.sensorData))}_handleError(e){u("error","at common/sensorManager.js:254","ä¼ æ„Ÿå™¨é”™è¯¯:",e),this.callbacks.error&&this.callbacks.error(e)}_detectSwimmingStroke(){const e=Date.now(),{acceleration:t,rotationRate:s}=this.sensorData;if(e-this.strokeState.lastTime<this.strokeConfig.cooldown)return;const a=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),i=Math.sqrt(s.alpha*s.alpha+s.beta*s.beta+s.gamma*s.gamma);this.strokeState.smoothedAccel=this.strokeState.smoothedAccel*this.strokeConfig.smoothing+a*(1-this.strokeConfig.smoothing),this.strokeState.smoothedRotation=this.strokeState.smoothedRotation*this.strokeConfig.smoothing+i*(1-this.strokeConfig.smoothing);const n=this.strokeState.smoothedAccel+this.strokeState.smoothedRotation;if(n>this.strokeConfig.threshold){const t=Math.max(this.strokeConfig.minPower,Math.min(n/this.strokeConfig.maxPower,1));this.strokeState.lastTime=e,this.strokeState.lastPower=t,this.strokeState.combo++,this.callbacks.motion&&this.callbacks.motion({...this.sensorData,stroke:!0,strokePower:t,strokeCombo:this.strokeState.combo})}else this.strokeState.combo=0}setStrokeConfig(e){this.strokeConfig={...this.strokeConfig,...e}}reset(){this.strokeState={lastTime:0,lastPower:0,combo:0,smoothedAccel:0,smoothedRotation:0}}onMotion(e){this.callbacks.motion=e}onOrientation(e){this.callbacks.orientation=e}onError(e){this.callbacks.error=e}}const p=l({name:"TestSensorsPage",data:()=>({sm:null,initializing:!1,listening:!1,permGranted:null,support:{isSupported:!1,needsPermission:!1,apis:{}},alpha:.8,windowSize:100,accRaw:{x:0,y:0,z:0},rotRaw:{alpha:0,beta:0,gamma:0},oriRaw:{alpha:0,beta:0,gamma:0},accFilt:{x:0,y:0,z:0},rotFilt:{alpha:0,beta:0,gamma:0},oriZero:{alpha:0,beta:0,gamma:0},oriRel:{alpha:0,beta:0,gamma:0},samples:0,lastTick:0,avgInterval:0,eps:0,lastError:"",logs:[]}),computed:{permText(){return!0===this.permGranted?"å·²æˆæƒ":!1===this.permGranted?"æœªæˆæƒ":this.support.needsPermission?"éœ€æˆæƒ":"æ— éœ€æˆæƒ"},accMag(){return Math.sqrt(this.accFilt.x**2+this.accFilt.y**2+this.accFilt.z**2)},rotMag(){return Math.sqrt(this.rotFilt.alpha**2+this.rotFilt.beta**2+this.rotFilt.gamma**2)},cubeStyle(){return{transform:`rotateX(${this.oriRel.beta}deg) rotateY(${this.oriRel.gamma}deg) rotateZ(${this.oriRel.alpha}deg)`}}},mounted(){try{const e=class{static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}static smoothFilter(e,t,s=.8){return t*s+e*(1-s)}static momentum(e,t){return{x:e.x*t.x,y:e.y*t.y,z:e.z*t.z}}static checkPlatformSupport(){const e=void 0!==plus.accelerometer,t=void 0!==plus.compass;return{platform:"app",isSupported:e&&t,needsPermission:!1,apis:{accelerometer:e,compass:t}}}static weightedAverage(e,t){let s=0,a=0;for(let i=0;i<e.length;i++)s+=e[i]*t[i],a+=t[i];return s/a}static analyzeSensorAnomalies(e,t={}){const{accelThreshold:s=20,rotationThreshold:a=15,noiseThreshold:i=.1}=t,n={hasAnomalies:!1,details:[]},o=this.magnitude(e.acceleration);o>s&&(n.hasAnomalies=!0,n.details.push({type:"acceleration",value:o,threshold:s}));const r=this.magnitude(e.rotationRate);return r>a&&(n.hasAnomalies=!0,n.details.push({type:"rotation",value:r,threshold:a})),Math.abs(e.acceleration.x)<i&&Math.abs(e.acceleration.y)<i&&Math.abs(e.acceleration.z)<i&&(n.hasAnomalies=!0,n.details.push({type:"noise",threshold:i})),n}static analyzeSwimmingStyle(e,t=10){const s={freestyle:{score:0,features:{armRotation:!1,bodyRoll:!1,rhythm:!1}},butterfly:{score:0,features:{symmetricArms:!1,bodyUndulation:!1,timing:!1}},breaststroke:{score:0,features:{symmetricPull:!1,legKick:!1,glide:!1}},backstroke:{score:0,features:{backPosition:!1,armRotation:!1,legKick:!1}}};this._analyzeFreestyle(e,s.freestyle),this._analyzeButterfly(e,s.butterfly),this._analyzeBreaststroke(e,s.breaststroke),this._analyzeBackstroke(e,s.backstroke);let a=null,i=0;for(const[n,o]of Object.entries(s))o.score>i&&(i=o.score,a=n);return{style:a,confidence:i/100,patterns:s}}static analyzeEfficiency(e){const{strokeCount:t,distance:s,time:a,energy:i}=e;return{strokesPerMinute:t/a*6e4,distancePerStroke:s/t,speed:s/a*1e3,energyEfficiency:s/i}}static analyzeStrokeQuality(e){const{acceleration:t,rotationRate:s,orientation:a}=e,i=this._calculateSymmetry(t,s),n=this._calculatePower(t),o=this._calculateSmoothness(t,s),r=this._calculateBalance(a),c=.3*i+.3*n+.2*o+.2*r;return{total:Math.round(100*c),details:{symmetry:Math.round(100*i),power:Math.round(100*n),smoothness:Math.round(100*o),balance:Math.round(100*r)},feedback:this._generateFeedback({symmetry:i,power:n,smoothness:o,balance:r})}}static _analyzeFreestyle(e,t){const{acceleration:s,rotationRate:a,orientation:i}=e;Math.abs(a.z)>1.5&&(t.score+=30,t.features.armRotation=!0),Math.abs(i.gamma)>30&&(t.score+=40,t.features.bodyRoll=!0),Math.abs(s.x)>1&&Math.abs(s.y)>.5&&(t.score+=30,t.features.rhythm=!0)}static _analyzeButterfly(e,t){const{acceleration:s,rotationRate:a}=e;Math.abs(s.x)<.5&&Math.abs(s.y)>2&&(t.score+=35,t.features.symmetricArms=!0),Math.abs(a.x)>1.2&&(t.score+=35,t.features.bodyUndulation=!0),Math.abs(s.z)>1.5&&(t.score+=30,t.features.timing=!0)}static _analyzeBreaststroke(e,t){const{acceleration:s,rotationRate:a}=e;Math.abs(s.x)<.8&&Math.abs(s.y)>1&&(t.score+=35,t.features.symmetricPull=!0),Math.abs(s.z)>1.2&&Math.abs(a.x)<.8&&(t.score+=35,t.features.legKick=!0),Math.abs(s.x)<.3&&Math.abs(s.y)<.3&&Math.abs(s.z)<.3&&(t.score+=30,t.features.glide=!0)}static _analyzeBackstroke(e,t){const{acceleration:s,orientation:a}=e;Math.abs(a.beta-180)<20&&(t.score+=35,t.features.backPosition=!0),Math.abs(s.x)>1.2&&Math.abs(s.y)<.8&&(t.score+=35,t.features.armRotation=!0),Math.abs(s.z)>.8&&(t.score+=30,t.features.legKick=!0)}static _generateFeedback(e){const t=[];return e.symmetry<.7&&t.push("ä¿æŒå·¦å³åˆ’æ°´åŠ¨ä½œçš„å¯¹ç§°æ€§"),e.power<.6&&t.push("å¢åŠ åˆ’æ°´åŠ›åº¦ï¼Œä½†æ³¨æ„ä¿æŒåŠ¨ä½œåè°ƒ"),e.smoothness<.7&&t.push("åŠ¨ä½œè¦æ›´æµç•…ï¼Œé¿å…æ€¥ä¿ƒåŠ¨ä½œ"),e.balance<.6&&t.push("æ³¨æ„èº«ä½“å¹³è¡¡ï¼Œä¿æŒæ­£ç¡®å§¿åŠ¿"),t}static _calculateSymmetry(e,t){const s=Math.abs(e.x)/(Math.abs(e.y)+.1),a=Math.abs(t.gamma)/(Math.abs(t.beta)+.1);return this.weightedAverage([s,a],[.6,.4])}static _calculatePower(e){const t=this.magnitude(e);return Math.min(t/10,1)}static _calculateSmoothness(e,t){const s=Math.abs(e.x*e.x+e.y*e.y+e.z*e.z),a=Math.abs(t.alpha*t.alpha+t.beta*t.beta+t.gamma*t.gamma);return 1-Math.min((s+a)/100,1)}static _calculateBalance(e){return 1-(Math.abs(e.beta-90)/90*.6+Math.abs(e.gamma)/90*.4)}}.checkPlatformSupport();this.support=e}catch(e){}this.sm=new d,this.sm.onMotion(this.onMotion),this.sm.onOrientation(this.onOrientation),this.sm.onError((e=>{this.lastError=e&&e.message?e.message:String(e)}))},methods:{async requestPermission(){this.initializing=!0;try{await this.sm.initialize(),this.permGranted=!0,uni.showToast({title:"å·²æˆæƒ",icon:"success"})}catch(e){this.permGranted=!1,uni.showModal({title:"æˆæƒå¤±è´¥",content:e.message||"æ— æ³•è·å–æƒé™"})}finally{this.initializing=!1}},start(){try{this.sm.startListening(),this.listening=!0,this.resetStats()}catch(e){this.lastError=e.message}},stop(){this.sm.stopListening(),this.listening=!1},resetCalib(){this.oriZero={...this.oriRaw}},onWindowChange(e){this.windowSize=[50,100,200,500][e.detail.value]||100},fmt:e=>(Number(e)||0).toFixed(2),barStyle:(e,t=100)=>({width:Math.min(100,Math.abs(e)/t*100)+"%"}),resetStats(){this.samples=0,this.avgInterval=0,this.eps=0,this.lastTick=0,this.logs=[]},onMotion(e){const t=performance.now?performance.now():Date.now(),s=e.acceleration||{x:0,y:0,z:0},a=e.rotationRate||{alpha:0,beta:0,gamma:0};this.accRaw=s,this.rotRaw=a;const i=this.alpha;if(this.accFilt={x:this.accFilt.x*i+s.x*(1-i),y:this.accFilt.y*i+s.y*(1-i),z:this.accFilt.z*i+s.z*(1-i)},this.rotFilt={alpha:this.rotFilt.alpha*i+a.alpha*(1-i),beta:this.rotFilt.beta*i+a.beta*(1-i),gamma:this.rotFilt.gamma*i+a.gamma*(1-i)},this.lastTick){const e=t-this.lastTick;this.avgInterval=0===this.avgInterval?e:.9*this.avgInterval+.1*e,this.eps=this.avgInterval>0?1e3/this.avgInterval:0}this.lastTick=t,this.samples++,this.logs.push({t:t,a:this.accRaw,r:this.rotRaw,o:this.oriRaw}),this.logs.length>this.windowSize&&this.logs.shift()},onOrientation(e){const t=e.orientation||{alpha:0,beta:0,gamma:0};this.oriRaw=t,this.oriRel={alpha:this.wrapDeg(t.alpha-this.oriZero.alpha,180),beta:this.clamp(t.beta-this.oriZero.beta,-180,180),gamma:this.clamp(t.gamma-this.oriZero.gamma,-90,90)}},wrapDeg(e,t=180){let s=e;for(;s>t;)s-=2*t;for(;s<-t;)s+=2*t;return s},clamp:(e,t,s)=>Math.max(t,Math.min(s,e)),clearLogs(){this.logs=[],uni.showToast({title:"å·²æ¸…é™¤",icon:"none"})},copyLogs(){try{const e=JSON.stringify(this.logs);uni.setClipboardData({data:e,success:()=>uni.showToast({title:"å·²å¤åˆ¶",icon:"success"})})}catch(e){uni.showToast({title:"å¤åˆ¶å¤±è´¥",icon:"none"})}}}},[["render",function(t,s,a,i,n,o){return e.openBlock(),e.createElementBlock("view",{class:"sensor-page"},[e.createElementVNode("view",{class:"topbar"},[e.createElementVNode("text",{class:"title"},"ä¼ æ„Ÿå™¨æµ‹è¯•"),e.createElementVNode("view",{class:"badges"},[e.createElementVNode("text",{class:e.normalizeClass(["badge",{ok:n.support.isSupported,warn:!n.support.isSupported}])},e.toDisplayString(n.support.isSupported?"å·²æ”¯æŒ":"ä¸æ”¯æŒ"),3),e.createElementVNode("text",{class:e.normalizeClass(["badge",{ok:!0===n.permGranted,warn:!1===n.permGranted}])},e.toDisplayString(o.permText),3),e.createElementVNode("text",{class:e.normalizeClass(["badge",{ok:n.listening,warn:!n.listening}])},e.toDisplayString(n.listening?"ç›‘å¬ä¸­":"æœªç›‘å¬"),3)])]),e.createElementVNode("view",{class:"controls"},[e.createElementVNode("button",{class:"btn primary",disabled:n.initializing,onClick:s[0]||(s[0]=(...e)=>o.requestPermission&&o.requestPermission(...e))},"æˆæƒ",8,["disabled"]),e.createElementVNode("button",{class:"btn",disabled:!n.permGranted||n.initializing||n.listening,onClick:s[1]||(s[1]=(...e)=>o.start&&o.start(...e))},"å¼€å§‹",8,["disabled"]),e.createElementVNode("button",{class:"btn",disabled:!n.listening,onClick:s[2]||(s[2]=(...e)=>o.stop&&o.stop(...e))},"åœæ­¢",8,["disabled"]),e.createElementVNode("button",{class:"btn",onClick:s[3]||(s[3]=(...e)=>o.resetCalib&&o.resetCalib(...e))},"æ ¡å‡†é›¶ç‚¹"),e.createElementVNode("button",{class:"btn",onClick:s[4]||(s[4]=(...e)=>o.clearLogs&&o.clearLogs(...e))},"æ¸…é™¤æ—¥å¿—"),e.createElementVNode("button",{class:"btn",onClick:s[5]||(s[5]=(...e)=>o.copyLogs&&o.copyLogs(...e))},"å¤åˆ¶æ—¥å¿—")]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("text",{class:"sec-title"},"å‚æ•°"),e.createElementVNode("view",{class:"kv"},[e.createElementVNode("text",{class:"k"},"æ»¤æ³¢Î±(0-1)"),e.withDirectives(e.createElementVNode("input",{class:"v-input",type:"number",step:"0.05","onUpdate:modelValue":s[6]||(s[6]=e=>n.alpha=e)},null,512),[[e.vModelText,n.alpha,void 0,{number:!0}]])]),e.createElementVNode("view",{class:"kv"},[e.createElementVNode("text",{class:"k"},"é‡‡æ ·çª—å£"),e.createElementVNode("picker",{range:[50,100,200,500],onChange:s[7]||(s[7]=(...e)=>o.onWindowChange&&o.onWindowChange(...e))},[e.createElementVNode("view",{class:"v"},e.toDisplayString(n.windowSize)+" æ¡",1)],32)])]),e.createElementVNode("view",{class:"grid"},[e.createElementVNode("view",{class:"card"},[e.createElementVNode("text",{class:"card-title"},"åŠ é€Ÿåº¦ (m/sÂ²)"),e.createElementVNode("view",{class:"rows"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(["x","y","z"],(t=>e.createElementVNode("view",{class:"row",key:"acc-"+t},[e.createElementVNode("text",{class:"label"},e.toDisplayString(t.toUpperCase()),1),e.createElementVNode("text",{class:"val"},e.toDisplayString(o.fmt(n.accFilt[t])),1),e.createElementVNode("view",{class:"bar"},[e.createElementVNode("view",{class:"fill",style:e.normalizeStyle(o.barStyle(n.accFilt[t],30))},null,4)])]))),64)),e.createElementVNode("view",{class:"row"},[e.createElementVNode("text",{class:"label"},"|a|"),e.createElementVNode("text",{class:"val"},e.toDisplayString(o.fmt(o.accMag)),1)])])]),e.createElementVNode("view",{class:"card"},[e.createElementVNode("text",{class:"card-title"},"æ—‹è½¬é€Ÿç‡ (Â°/s)"),e.createElementVNode("view",{class:"rows"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(["alpha","beta","gamma"],(t=>e.createElementVNode("view",{class:"row",key:"rot-"+t},[e.createElementVNode("text",{class:"label"},e.toDisplayString(t),1),e.createElementVNode("text",{class:"val"},e.toDisplayString(o.fmt(n.rotFilt[t])),1),e.createElementVNode("view",{class:"bar"},[e.createElementVNode("view",{class:"fill",style:e.normalizeStyle(o.barStyle(n.rotFilt[t],300))},null,4)])]))),64)),e.createElementVNode("view",{class:"row"},[e.createElementVNode("text",{class:"label"},"|Ï‰|"),e.createElementVNode("text",{class:"val"},e.toDisplayString(o.fmt(o.rotMag)),1)])])]),e.createElementVNode("view",{class:"card"},[e.createElementVNode("text",{class:"card-title"},"æ–¹å‘è§’ (Â°) - é›¶ç‚¹æ ¡å‡†"),e.createElementVNode("view",{class:"rows"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(["alpha","beta","gamma"],(t=>e.createElementVNode("view",{class:"row",key:"ori-"+t},[e.createElementVNode("text",{class:"label"},e.toDisplayString(t),1),e.createElementVNode("text",{class:"val"},e.toDisplayString(o.fmt(n.oriRel[t])),1),e.createElementVNode("view",{class:"bar"},[e.createElementVNode("view",{class:"fill",style:e.normalizeStyle(o.barStyle(n.oriRel[t],"alpha"===t?180:90))},null,4)])]))),64))])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("text",{class:"sec-title"},"ç»Ÿè®¡"),e.createElementVNode("view",{class:"stats"},[e.createElementVNode("text",null,"äº‹ä»¶æ•°ï¼š"+e.toDisplayString(n.samples),1),e.createElementVNode("text",null,"é‡‡æ ·ç‡ï¼š"+e.toDisplayString(n.eps.toFixed(1))+" evt/s",1),e.createElementVNode("text",null,"é—´éš”å‡å€¼ï¼š"+e.toDisplayString(Math.round(n.avgInterval))+" ms",1),e.createElementVNode("text",null,"ç›‘å¬é”™è¯¯ï¼š"+e.toDisplayString(n.lastError||"æ— "),1)])]),e.createElementVNode("view",{class:"tiltbox-wrap"},[e.createElementVNode("text",{class:"sec-title"},"å€¾æ–œå¯è§†åŒ–"),e.createElementVNode("view",{class:"tiltbox"},[e.createElementVNode("view",{class:"cube",style:e.normalizeStyle(o.cubeStyle)},null,4)])])])}],["__scopeId","data-v-24991de2"]]);class g{constructor(){this.gameState="ready",this.gameTime=0,this.maxGameTime=6e4,this.distance=0,this.speed=0,this.score=0,this.strokeCount=0,this.lives=3,this.coinStreak=0,this.invulnerableUntil=0,this.endReason=null,this.player={x:50,y:50,size:20,speed:0,maxSpeed:3,acceleration:.05,deceleration:.02,vx:0,vy:0,hitRadius:3.8},this.obstacles=[],this.coins=[],this.particles=[],this.settings={obstacleSpawnRate:.02,coinSpawnRate:.01,obstacleIntervalStart:1600,obstacleIntervalEnd:700,coinIntervalStart:1200,coinIntervalEnd:1e3,obstacleMaxStart:5,obstacleMaxEnd:10,coinMax:8,obstacleSpeed:2,coinSpeed:1.5,obstacleSize:15,coinSize:10,moveScale:22,dirSmoothing:8,deadZone:.05,baseForwardSpeed:.3,hitInvulnMs:1200,maxLives:5,coinStreakTarget:3,hitRadiusPlayerPct:3.8,hitRadiusCoinPct:2.4,hitRadiusObstaclePct:3.2},this.callbacks={onStateChange:null,onScoreUpdate:null,onGameOver:null},this.gameLoop=null,this.lastTime=0,this._obstacleTimer=0,this._coinTimer=0,this.dirX=0,this.dirY=0,this.headingX=1,this.headingY=0}init(){this.resetGame(),u("log","at common/swimmingGame.js:97","æ¸¸æ³³æ¸¸æˆå·²åˆå§‹åŒ–")}resetGame(){this.gameState="ready",this.gameTime=0,this.distance=0,this.speed=0,this.score=0,this.strokeCount=0,this.lives=3,this.coinStreak=0,this.invulnerableUntil=0,this.endReason=null,this._obstacleTimer=0,this._coinTimer=0,this.player={x:50,y:50,size:20,speed:0,maxSpeed:3,acceleration:.05,deceleration:.02,vx:0,vy:0,hitRadius:this.settings.hitRadiusPlayerPct},this.obstacles=[],this.coins=[],this.particles=[],this.dirX=0,this.dirY=0,this.headingX=1,this.headingY=0}startGame(){"ready"!==this.gameState&&"ended"!==this.gameState||(this.gameState="playing",this.lastTime="undefined"!=typeof performance&&performance.now?performance.now():Date.now(),this.startGameLoop(),this.triggerCallback("onStateChange",this.gameState),u("log","at common/swimmingGame.js:154","æ¸¸æˆå¼€å§‹"))}pauseGame(){"playing"===this.gameState&&(this.gameState="paused",this.stopGameLoop(),this.triggerCallback("onStateChange",this.gameState),u("log","at common/swimmingGame.js:169","æ¸¸æˆæš‚åœ"))}resumeGame(){"paused"===this.gameState&&(this.gameState="playing",this.lastTime="undefined"!=typeof performance&&performance.now?performance.now():Date.now(),this.startGameLoop(),this.triggerCallback("onStateChange",this.gameState),u("log","at common/swimmingGame.js:185","æ¸¸æˆæ¢å¤"))}endGame(){this.gameState="ended",this.stopGameLoop(),this.triggerCallback("onStateChange",this.gameState),this.triggerCallback("onGameOver",{score:this.score,distance:this.distance,strokeCount:this.strokeCount,time:this.gameTime,lives:this.lives,endReason:this.endReason}),u("log","at common/swimmingGame.js:205","æ¸¸æˆç»“æŸ",{score:this.score,distance:this.distance,strokeCount:this.strokeCount,lives:this.lives,endReason:this.endReason})}startGameLoop(){this.gameLoop||(this.gameLoop=e=>{if("playing"!==this.gameState)return;this.lastTime||(this.lastTime=e);const t=e-this.lastTime;this.lastTime=e,this.updateGame(t),this._rafId=requestAnimationFrame(this.gameLoop)},this._rafId=requestAnimationFrame(this.gameLoop))}stopGameLoop(){this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=null),this.gameLoop=null}updateGame(e){if(this.gameTime+=e,this.gameTime>=this.maxGameTime)return this.endReason="time",void this.endGame();this.updatePlayer(e),this.updateObstacles(e),this.updateCoins(e),this.updateParticles(e),this.spawnObjects(e),this.checkCollisions(),this.updateDistance(),this.updateSpeed()}updatePlayer(e){const t=e/1e3;let s=Math.abs(this.dirX)>this.settings.deadZone?this.dirX:Math.abs(this.tiltX||0)>this.settings.deadZone?this.tiltX:0,a=Math.abs(this.dirY)>this.settings.deadZone?this.dirY:Math.abs(this.tiltY||0)>this.settings.deadZone?this.tiltY:0;const i=Math.sqrt(s*s+a*a);i>1&&(s/=i,a/=i);const n=s*this.player.maxSpeed,o=a*this.player.maxSpeed,r=Math.min(1,this.settings.dirSmoothing*t);if(this.player.vx+=(n-this.player.vx)*r,this.player.vy+=(o-this.player.vy)*r,i>this.settings.deadZone){const e=Math.sqrt(s*s+a*a)||1;this.headingX=s/e,this.headingY=a/e}if(0===i){const t=Math.pow(.92,e/16.67);this.player.vx*=t,this.player.vy*=t}this.player.x+=this.player.vx*this.settings.moveScale*t,this.player.y+=this.player.vy*this.settings.moveScale*t;const c=(this.settings.autoMoveScale||6)*t;this.player.x+=this.headingX*c*.2,this.player.y+=this.headingY*c*.2,this.player.x=Math.max(5,Math.min(95,this.player.x)),this.player.y=Math.max(5,Math.min(95,this.player.y)),this.player.speed=Math.sqrt(this.player.vx*this.player.vx+this.player.vy*this.player.vy)}setTilt(e,t){this.tiltX=Math.max(-1,Math.min(1,e)),this.tiltY=Math.max(-1,Math.min(1,t))}setDirection(e,t){this.dirX=Math.max(-1,Math.min(1,e)),this.dirY=Math.max(-1,Math.min(1,t))}nudge(e=0,t=0){"playing"===this.gameState&&(this.player.x=Math.max(5,Math.min(95,this.player.x+e)),this.player.y=Math.max(5,Math.min(95,this.player.y+t)))}spawnObstacle(){"playing"===this.gameState&&this.addObstacle()}spawnCoin(){"playing"===this.gameState&&this.addCoin()}boostSpeed(e=.5){"playing"===this.gameState&&(this.player.speed=Math.min(this.player.speed+e,this.player.maxSpeed))}simulateStroke(e=1){"playing"===this.gameState&&this.addParticle(this.player.x,this.player.y,"stroke")}updateObstacles(e){for(let t=this.obstacles.length-1;t>=0;t--){const s=this.obstacles[t];s.x-=this.settings.obstacleSpeed*e*.01,s.x<-this.settings.obstacleSize&&(s.isActive=!1,this.obstacles.splice(t,1))}}updateCoins(e){for(let t=this.coins.length-1;t>=0;t--){const s=this.coins[t];s.x-=this.settings.coinSpeed*e*.01,s.x<-this.settings.coinSize&&(s.isActive=!1,this.coins.splice(t,1))}}updateParticles(e){for(let t=this.particles.length-1;t>=0;t--){const s=this.particles[t];s.x+=s.vx*e*.01,s.y+=s.vy*e*.01,s.life-=e,s.life<=0&&this.particles.splice(t,1)}}spawnObjects(e){const t=Math.max(0,e||0),s=Math.min(1,this.gameTime/this.maxGameTime),a=(e,t,s)=>e+(t-e)*s,i=a(this.settings.obstacleIntervalStart,this.settings.obstacleIntervalEnd,s),n=a(this.settings.coinIntervalStart,this.settings.coinIntervalEnd,s),o=Math.round(a(this.settings.obstacleMaxStart,this.settings.obstacleMaxEnd,s)),r=this.settings.coinMax||8;this._obstacleTimer-=t,this._coinTimer-=t;const c=(e,t=.85,s=1.15)=>e*(t+Math.random()*(s-t));for(;this._obstacleTimer<=0;)this.obstacles.length<o&&this.addObstacle(),this._obstacleTimer+=c(i,.85,1.15);for(;this._coinTimer<=0;)this.coins.length<r&&this.addCoin(),this._coinTimer+=c(n,.9,1.1)}addObstacle(){if(this.obstaclesPool||(this.obstaclesPool=[]),this.maxObstaclePool||(this.maxObstaclePool=30),!this.obstaclesPool.length)for(let t=0;t<this.maxObstaclePool;t++)this.obstaclesPool.push({x:0,y:0,size:this.settings.obstacleSize,type:"obstacle",hitRadius:this.settings.hitRadiusObstaclePct,isActive:!1});const e=this.obstaclesPool.find((e=>!e.isActive));e&&(e.x=110,e.y=80*Math.random()+10,e.size=this.settings.obstacleSize,e.hitRadius=this.settings.hitRadiusObstaclePct,e.isActive=!0,this.obstacles.push(e))}addCoin(){if(this.coinsPool||(this.coinsPool=[]),this.maxCoinPool||(this.maxCoinPool=30),!this.coinsPool.length)for(let t=0;t<this.maxCoinPool;t++)this.coinsPool.push({x:0,y:0,size:this.settings.coinSize,type:"coin",value:1,hitRadius:this.settings.hitRadiusCoinPct,isActive:!1});const e=this.coinsPool.find((e=>!e.isActive));e&&(e.x=110,e.y=80*Math.random()+10,e.size=this.settings.coinSize,e.value=1,e.hitRadius=this.settings.hitRadiusCoinPct,e.isActive=!0,this.coins.push(e))}addParticle(e,t,s){const a={x:e,y:t,vx:2*(Math.random()-.5),vy:2*(Math.random()-.5),life:1e3,type:s};this.particles.push(a)}checkCollisions(){for(let e=this.obstacles.length-1;e>=0;e--){const t=this.obstacles[e];if(this.checkCollision(this.player,t)){const s="undefined"!=typeof performance&&performance.now?performance.now():Date.now();if(s<this.invulnerableUntil){this.obstacles.splice(e,1);continue}if(this.obstacles.splice(e,1),this.addParticle(t.x,t.y,"hit"),this.lives=Math.max(0,this.lives-1),this.coinStreak=0,this.invulnerableUntil=s+this.settings.hitInvulnMs,0===this.lives)return this.endReason="lives",void this.endGame()}}for(let e=this.coins.length-1;e>=0;e--){const t=this.coins[e];this.checkCollision(this.player,t)&&(this.score+=1,this.coinStreak+=1,this.coinStreak%this.settings.coinStreakTarget==0&&this.lives<this.settings.maxLives&&(this.lives+=1,this.addParticle(t.x,t.y,"life")),this.coins.splice(e,1),this.addParticle(t.x,t.y,"coin"),this.triggerCallback("onScoreUpdate",this.score))}}checkCollision(e,t){const s=e.x-t.x,a=e.y-t.y;return Math.sqrt(s*s+a*a)<("number"==typeof e.hitRadius?e.hitRadius:3)+("number"==typeof t.hitRadius?t.hitRadius:3)}updateDistance(){this.distance+=.1*(this.settings.baseForwardSpeed+.4*this.player.speed)}updateSpeed(){this.speed=this.player.speed}getGameData(){return{state:this.gameState,time:this.gameTime,maxTime:this.maxGameTime,maxLives:this.settings.maxLives,distance:this.distance,speed:this.speed,score:this.score,strokeCount:this.strokeCount,lives:this.lives,player:{...this.player},obstacles:[...this.obstacles],coins:[...this.coins],particles:[...this.particles]}}onStateChange(e){this.callbacks.onStateChange=e}onScoreUpdate(e){this.callbacks.onScoreUpdate=e}onGameOver(e){this.callbacks.onGameOver=e}triggerCallback(e,t){this.callbacks[e]&&this.callbacks[e](t)}}const y=l({name:"SwimmingPage",components:{SwimmingGameUI:l({name:"SwimmingGameUI",data:()=>({sensorManager:null,swimmingGame:null,sensorReady:!1,permissionError:"",isSwimming:!1,gameData:{score:0,distance:0,speed:0,strokeCount:0,lives:3,maxSpeed:0,player:{x:50,y:50,size:20},obstacles:[],coins:[],particles:[],time:0,maxTime:6e4},gameState:"ready",endReason:null,waveOffset:0,_lastSync:0,_syncInterval:1e3/30,showDebugWheel:!1,wheelPos:{x:100,y:220},wheelDragging:!1,wheelDragOffset:{x:0,y:0},stickX:0,stickY:0,stickActive:!1,_stickMoveHandler:null,_stickEndHandler:null}),computed:{livesHearts(){const e=Math.max(0,this.gameData&&"number"==typeof this.gameData.lives?this.gameData.lives:0),t=this.gameData&&"number"==typeof this.gameData.maxLives?this.gameData.maxLives:Math.max(e,3),s=Math.min(e,t);return"â¤ï¸".repeat(s)+"ğŸ¤".repeat(Math.max(0,t-s))},endMessage(){return this.endReason?"time"===this.endReason?"æ—¶é—´åˆ°ï¼ŒæŒ‘æˆ˜ç»“æŸ":"lives"===this.endReason?"ç”Ÿå‘½è€—å°½ï¼ŒæŒ‘æˆ˜ç»“æŸ":"æŒ‘æˆ˜ç»“æŸ":""},timeDisplay(){const e=Math.max(0,this.gameData.maxTime-this.gameData.time),t=Math.ceil(e/1e3);return`${Math.floor(t/60)}:${(t%60).toString().padStart(2,"0")}`},distanceDisplay(){return Math.round(this.gameData.distance)},speedDisplay(){return(10*this.gameData.speed).toFixed(1)},maxSpeedDisplay(){return(10*this.gameData.maxSpeed).toFixed(1)},playerStyle(){return{left:this.gameData.player.x+"%",top:this.gameData.player.y+"%"}},stickStyle(){return{transform:`translate(-50%,-50%) translate(${40*this.stickX}px, ${40*this.stickY}px)`}}},mounted(){this.initGame()},beforeUnmount(){this.cleanup()},methods:{async initGame(){this.sensorManager=new d,this.sensorManager.onMotion(this.handleMotion),this.sensorManager.onError((e=>u("error","at components/SwimmingGameUI.vue:196","ä¼ æ„Ÿå™¨é”™è¯¯",e))),this.swimmingGame=new g,this.swimmingGame.onStateChange((e=>{this.gameState=e})),this.swimmingGame.onScoreUpdate((e=>{this.gameData.score=e})),this.swimmingGame.onGameOver((e=>{u("log","at components/SwimmingGameUI.vue:201","GameOver",e)})),this.swimmingGame.onGameOver((e=>{try{const t=uni.getStorageSync("bestScore");(!t||e.score>t)&&uni.setStorageSync("bestScore",e.score),uni.setStorageSync("recentScore",e.score),this.endReason=e&&e.endReason?e.endReason:null,e&&"number"==typeof e.lives&&(this.gameData.lives=e.lives);const s=Number(uni.getStorageSync("longestGameMs")||0),a=Number(e&&e.time?e.time:0);!isNaN(a)&&a>s&&uni.setStorageSync("longestGameMs",a);const i=Number(uni.getStorageSync("totalGames")||0);uni.setStorageSync("totalGames",i+1);const n=Number(uni.getStorageSync("totalCoins")||0),o="number"==typeof e.score&&e.score>0?e.score:0;uni.setStorageSync("totalCoins",n+o)}catch(t){u("warn","at components/SwimmingGameUI.vue:228","ä¿å­˜åˆ†æ•°å¤±è´¥",t)}})),this.swimmingGame.init();try{await this.sensorManager.initialize(),this.sensorManager.startListening(),this.sensorReady=!0,this.permissionError=""}catch(e){u("warn","at components/SwimmingGameUI.vue:239","ä¼ æ„Ÿå™¨æœªå°±ç»ª:",e.message),this.permissionError=e.message||"æ— æ³•è·å–ä¼ æ„Ÿå™¨"}},async retryPermission(){this.permissionError="",this.sensorReady=!1;try{await this.sensorManager.initialize(),this.sensorManager.startListening(),this.sensorReady=!0}catch(e){this.permissionError=e.message||"æˆæƒå¤±è´¥"}},enableJoystickMode(){this.joystickOnly=!0,this.sensorReady=!0,this.permissionError="",this.showDebugWheel=!0},startGame(){this.sensorReady&&(this.swimmingGame.startGame(),this.tickSync())},pauseGame(){this.swimmingGame.pauseGame()},resumeGame(){this.swimmingGame.resumeGame(),this.tickSync()},endGame(){this.swimmingGame.endGame()},togglePause(){"playing"===this.gameState?this.pauseGame():"paused"===this.gameState&&this.resumeGame()},restartGame(){this.endReason=null,this.swimmingGame.resetGame(),this.swimmingGame.startGame(),this.tickSync()},toggleDebugWheel(){this.showDebugWheel=!this.showDebugWheel},doLogout(){try{o()}catch(e){}uni.reLaunch({url:"/pages/auth/login"})},wheelAction(e){switch(e){case"up":this.swimmingGame.nudge(0,-3);break;case"down":this.swimmingGame.nudge(0,3);break;case"left":this.swimmingGame.nudge(-3,0);break;case"right":this.swimmingGame.nudge(3,0);break;case"obstacle":this.swimmingGame.spawnObstacle();break;case"coin":this.swimmingGame.spawnCoin();break;case"speed+":this.swimmingGame.boostSpeed(.5);break;case"speed-":this.swimmingGame.player.speed=Math.max(0,this.swimmingGame.player.speed-.5);break;case"stroke":this.swimmingGame.simulateStroke(1.2);break;case"pause":this.pauseGame();break;case"resume":this.resumeGame();break;case"end":this.endGame()}},startStick(e){const t=e.touches?e.touches[0]:e;this.stickActive=!0,this.updateStick(t),this._stickMoveHandler||(this._stickMoveHandler=e=>this.onStickMove(e)),this._stickEndHandler||(this._stickEndHandler=()=>this.endStick()),window.addEventListener("touchmove",this._stickMoveHandler,{passive:!1}),window.addEventListener("mousemove",this._stickMoveHandler),window.addEventListener("touchend",this._stickEndHandler),window.addEventListener("mouseup",this._stickEndHandler)},onStickMove(e){if(!this.stickActive)return;const t=e.touches?e.touches[0]:e;this.updateStick(t),e.cancelable&&e.preventDefault()},endStick(){this.stickActive=!1,this.stickX=0,this.stickY=0,this.swimmingGame&&this.swimmingGame.setDirection(0,0),this._stickMoveHandler&&(window.removeEventListener("touchmove",this._stickMoveHandler),window.removeEventListener("mousemove",this._stickMoveHandler)),this._stickEndHandler&&(window.removeEventListener("touchend",this._stickEndHandler),window.removeEventListener("mouseup",this._stickEndHandler))},updateStick(e){let t=null;const s=this.$refs&&this.$refs.joystick;if(s&&"function"==typeof s.getBoundingClientRect)t=s.getBoundingClientRect();else if(this.$el&&"function"==typeof this.$el.querySelector){const e=this.$el.querySelector(".joystick");e&&"function"==typeof e.getBoundingClientRect&&(t=e.getBoundingClientRect())}if(!t)return;const a=t.left+t.width/2,i=t.top+t.height/2,n=e.clientX-a,o=e.clientY-i,r=t.width/2-20,c=Math.sqrt(n*n+o*o),l=Math.min(c,r)/r,h=n/c*l||0,m=o/c*l||0;this.stickX=h,this.stickY=m,this.swimmingGame&&this.swimmingGame.setDirection(h,m)},startWheelDrag(e){const t=e.touches?e.touches[0]:e,s=e.target||e.touches&&e.touches[0]&&e.touches[0].target;this.stickActive||s&&s.closest&&s.closest(".joystick")||(this.wheelDragging=!0,this.wheelDragOffset.x=t.clientX-this.wheelPos.x,this.wheelDragOffset.y=t.clientY-this.wheelPos.y,window.addEventListener("touchmove",this.onWheelDrag,{passive:!1}),window.addEventListener("mousemove",this.onWheelDrag),window.addEventListener("touchend",this.endWheelDrag),window.addEventListener("mouseup",this.endWheelDrag))},onWheelDrag(e){if(!this.wheelDragging)return;const t=e.touches?e.touches[0]:e,s=t.clientX-this.wheelDragOffset.x,a=t.clientY-this.wheelDragOffset.y,i=window.innerWidth,n=window.innerHeight;this.wheelPos.x=Math.max(20,Math.min(i-260,s)),this.wheelPos.y=Math.max(80,Math.min(n-260,a)),e.cancelable&&e.preventDefault()},endWheelDrag(){this.wheelDragging=!1,window.removeEventListener("touchmove",this.onWheelDrag),window.removeEventListener("mousemove",this.onWheelDrag),window.removeEventListener("touchend",this.endWheelDrag),window.removeEventListener("mouseup",this.endWheelDrag)},handleMotion(e){const t=e.orientation||{},s=(t.gamma||0)/90,a=Math.max(-90,Math.min(90,t.beta||0))/90;this.swimmingGame.setTilt(s,a)},tickSync(){const e=t=>{if("playing"===this.gameState){if(!this._lastSync||t-this._lastSync>=this._syncInterval){const e=this.swimmingGame.getGameData();e.speed>e.maxSpeed&&(e.maxSpeed=e.speed),this.gameData=e,this._lastSync=t}requestAnimationFrame(e)}};requestAnimationFrame(e)},objectStyle:e=>({left:e.x+"%",top:e.y+"%",width:e.size+"px",height:e.size+"px"}),particleStyle:e=>({left:e.x+"%",top:e.y+"%",opacity:(e.life/1e3).toFixed(2)}),cleanup(){this.sensorManager&&this.sensorManager.stopListening(),this.swimmingGame&&this.swimmingGame.stopGameLoop()}}},[["render",function(t,s,a,i,n,o){return e.openBlock(),e.createElementBlock("view",{class:"swimming-game-container"},[n.permissionError?(e.openBlock(),e.createElementBlock("view",{key:0,class:"overlay"},[e.createElementVNode("view",{class:"overlay-box"},[e.createElementVNode("text",{class:"ov-title"},"ä¼ æ„Ÿå™¨ä¸å¯ç”¨"),e.createElementVNode("text",{class:"ov-msg"},[e.createTextVNode(e.toDisplayString(n.permissionError)+" ",1),n.sensorReady?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode("å¦‚æœå¤šæ¬¡æˆæƒå¤±è´¥ï¼Œä»å¯ä½¿ç”¨â€œæ‘‡æ†æ¨¡å¼â€ä½“éªŒæ¸¸æˆã€‚")],64))]),e.createElementVNode("view",{style:{display:"flex",gap:"24rpx","flex-wrap":"wrap","justify-content":"center"}},[e.createElementVNode("button",{class:"btn primary",onClick:s[0]||(s[0]=(...e)=>o.retryPermission&&o.retryPermission(...e))},"é‡è¯•æˆæƒ"),e.createElementVNode("button",{class:"btn",onClick:s[1]||(s[1]=(...e)=>o.enableJoystickMode&&o.enableJoystickMode(...e))},"ä»…æ‘‡æ†æ¨¡å¼")])])])):e.createCommentVNode("",!0),"ready"===n.gameState?(e.openBlock(),e.createElementBlock("view",{key:1,class:"panel start"},[e.createElementVNode("text",{class:"title"},"æ¸¸æ³³æ¸¸æˆ"),e.createElementVNode("text",{class:"subtitle"},"å€¾æ–œæ‰‹æœºæ¥æ§åˆ¶æ–¹å‘ï¼Œæ”¶é›†é‡‘å¸å¹¶èº²é¿éšœç¢"),e.createElementVNode("button",{class:"btn primary",disabled:!n.sensorReady,onClick:s[2]||(s[2]=(...e)=>o.startGame&&o.startGame(...e))},e.toDisplayString(n.sensorReady?"å¼€å§‹æ¸¸æˆ":"ç­‰å¾…ä¼ æ„Ÿå™¨æƒé™"),9,["disabled"]),e.createElementVNode("view",{class:"tips"},[e.createElementVNode("text",null,"ğŸ“± å€¾æ–œæ‰‹æœºï¼šå·¦å³/å‰åæ§åˆ¶æ–¹å‘"),e.createElementVNode("text",null,"ğŸ¯ æ”¶é›†é‡‘å¸ï¼Œé¿å¼€éšœç¢ç‰©"),e.createElementVNode("text",null,"â° æ¸¸æˆæ—¶é•¿ï¼š60ç§’")])])):"playing"===n.gameState?(e.openBlock(),e.createElementBlock("view",{key:2,class:"panel playing"},[e.createElementVNode("view",{class:"hud"},[e.createElementVNode("view",{class:"hud-item"},[e.createElementVNode("text",{class:"label"},"åˆ†æ•°"),e.createElementVNode("text",{class:"val"},e.toDisplayString(n.gameData.score),1)]),e.createElementVNode("view",{class:"hud-item"},[e.createElementVNode("text",{class:"label"},"è·ç¦»"),e.createElementVNode("text",{class:"val"},e.toDisplayString(o.distanceDisplay)+"m",1)]),e.createElementVNode("view",{class:"hud-item"},[e.createElementVNode("text",{class:"label"},"é€Ÿåº¦"),e.createElementVNode("text",{class:"val"},e.toDisplayString(o.speedDisplay)+"km/h",1)]),e.createElementVNode("view",{class:"hud-item"},[e.createElementVNode("text",{class:"label"},"å‰©ä½™"),e.createElementVNode("text",{class:"val"},e.toDisplayString(o.timeDisplay),1)]),e.createElementVNode("view",{class:"hud-item"},[e.createElementVNode("text",{class:"label"},"ç”Ÿå‘½"),e.createElementVNode("text",{class:"val"},e.toDisplayString(o.livesHearts),1)]),e.createElementVNode("view",{class:"hud-item"},[e.createElementVNode("text",{class:"label"},"æœ€é«˜é€Ÿ"),e.createElementVNode("text",{class:"val"},e.toDisplayString(o.maxSpeedDisplay)+"km/h",1)])]),e.createElementVNode("view",{class:"life-badge","aria-label":"ç”Ÿå‘½"},e.toDisplayString(o.livesHearts),1),e.createElementVNode("view",{class:"game-area"},[e.createElementVNode("view",{class:e.normalizeClass(["player",{swimming:n.isSwimming}]),style:e.normalizeStyle(o.playerStyle)},"ğŸŠâ€â™‚ï¸",6),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.gameData.obstacles,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:"ob-"+s,class:"obj obstacle",style:e.normalizeStyle(o.objectStyle(t))},"ğŸª¨",4)))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.gameData.coins,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:"coin-"+s,class:"obj coin",style:e.normalizeStyle(o.objectStyle(t))},"ğŸª™",4)))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.gameData.particles,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:"p-"+s,class:"obj particle",style:e.normalizeStyle(o.particleStyle(t))},"âœ¨",4)))),128))]),e.createElementVNode("view",{class:"bottom-toolbar"},[e.createElementVNode("button",{class:"tb-btn",onClick:s[3]||(s[3]=(...e)=>o.togglePause&&o.togglePause(...e)),"aria-label":"playing"===n.gameState?"æš‚åœ":"ç»§ç»­"},e.toDisplayString("playing"===n.gameState?"â¸ï¸":"â–¶ï¸"),9,["aria-label"]),e.createElementVNode("button",{class:"tb-btn",onClick:s[4]||(s[4]=(...e)=>o.restartGame&&o.restartGame(...e)),"aria-label":"é‡å¼€"},"ğŸ”„"),e.createElementVNode("button",{class:"tb-btn danger",onClick:s[5]||(s[5]=(...e)=>o.endGame&&o.endGame(...e)),"aria-label":"ç»“æŸ"},"â¹")]),e.createElementVNode("view",{class:"debug-toggle",onClick:s[6]||(s[6]=(...e)=>o.toggleDebugWheel&&o.toggleDebugWheel(...e))},"ğŸ› ï¸"),n.showDebugWheel?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["debug-wheel",{dragging:n.wheelDragging}]),style:e.normalizeStyle({left:n.wheelPos.x+"px",top:n.wheelPos.y+"px"}),onMousedown:s[19]||(s[19]=e.withModifiers(((...e)=>o.startWheelDrag&&o.startWheelDrag(...e)),["prevent"])),onTouchstart:s[20]||(s[20]=e.withModifiers(((...e)=>o.startWheelDrag&&o.startWheelDrag(...e)),["prevent"]))},[e.createElementVNode("view",{class:"joystick",ref:"joystick",onMousedown:s[7]||(s[7]=e.withModifiers(((...e)=>o.startStick&&o.startStick(...e)),["stop","prevent"])),onTouchstart:s[8]||(s[8]=e.withModifiers(((...e)=>o.startStick&&o.startStick(...e)),["stop","prevent"])),onMousemove:s[9]||(s[9]=e.withModifiers(((...e)=>o.onStickMove&&o.onStickMove(...e)),["stop","prevent"])),onTouchmove:s[10]||(s[10]=e.withModifiers(((...e)=>o.onStickMove&&o.onStickMove(...e)),["stop","prevent"]))},[e.createElementVNode("view",{class:"stick",style:e.normalizeStyle(o.stickStyle)},null,4)],544),e.createElementVNode("view",{class:"dbg-row"},[e.createElementVNode("button",{class:"dbg-small",onClick:s[11]||(s[11]=e=>o.wheelAction("obstacle"))},"éšœç¢+"),e.createElementVNode("button",{class:"dbg-small",onClick:s[12]||(s[12]=e=>o.wheelAction("coin"))},"é‡‘å¸+"),e.createElementVNode("button",{class:"dbg-small",onClick:s[13]||(s[13]=e=>o.wheelAction("speed+"))},"é€Ÿåº¦+"),e.createElementVNode("button",{class:"dbg-small",onClick:s[14]||(s[14]=e=>o.wheelAction("speed-"))},"é€Ÿåº¦-")]),e.createElementVNode("view",{class:"dbg-row"},[e.createElementVNode("button",{class:"dbg-small",onClick:s[15]||(s[15]=e=>o.wheelAction("stroke"))},"ç²’å­"),e.createElementVNode("button",{class:"dbg-small",onClick:s[16]||(s[16]=e=>o.wheelAction(n.swimmingGame&&"playing"===n.swimmingGame.gameState?"pause":"resume"))},e.toDisplayString(n.swimmingGame&&"playing"===n.swimmingGame.gameState?"æš‚åœ":"ç»§ç»­"),1),e.createElementVNode("button",{class:"dbg-small",onClick:s[17]||(s[17]=e=>o.wheelAction("end"))},"ç»“æŸ"),e.createElementVNode("button",{class:"dbg-small",onClick:s[18]||(s[18]=(...e)=>o.restartGame&&o.restartGame(...e))},"é‡å¼€")])],38)):e.createCommentVNode("",!0)])):"paused"===n.gameState?(e.openBlock(),e.createElementBlock("view",{key:3,class:"panel paused"},[e.createElementVNode("text",{class:"title"},"å·²æš‚åœ"),e.createElementVNode("button",{class:"btn primary",onClick:s[21]||(s[21]=(...e)=>o.resumeGame&&o.resumeGame(...e))},"ç»§ç»­"),e.createElementVNode("button",{class:"btn",onClick:s[22]||(s[22]=(...e)=>o.endGame&&o.endGame(...e))},"ç»“æŸ")])):(e.openBlock(),e.createElementBlock("view",{key:4,class:"panel ended"},[e.createElementVNode("text",{class:"title"},"æ¸¸æˆç»“æŸ"),n.endReason?(e.openBlock(),e.createElementBlock("text",{key:0,class:"subtitle"},e.toDisplayString(o.endMessage),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"summary"},[e.createElementVNode("text",null,"åˆ†æ•°ï¼š"+e.toDisplayString(n.gameData.score),1),e.createElementVNode("text",null,"è·ç¦»ï¼š"+e.toDisplayString(o.distanceDisplay)+"m",1),e.createElementVNode("text",null,"æœ€é«˜é€Ÿåº¦ï¼š"+e.toDisplayString(o.maxSpeedDisplay)+"km/h",1),e.createElementVNode("text",null,"å‰©ä½™ç”Ÿå‘½ï¼š"+e.toDisplayString(o.livesHearts),1)]),e.createElementVNode("button",{class:"btn primary",onClick:s[23]||(s[23]=(...e)=>o.restartGame&&o.restartGame(...e))},"å†ç©ä¸€æ¬¡")]))])}],["__scopeId","data-v-2cf1759e"]])},data:()=>({showInstructions:!1,showPermissionTip:!1,gameStarted:!1,countdown:0,bestScore:uni.getStorageSync("bestScore")||0}),onLoad(){this.checkSensorSupport()},onShow(){this.checkSensorStatus()},methods:{checkSensorSupport(){const e="DeviceMotionEvent"in window,t="DeviceOrientationEvent"in window;return!(!e&&!t)||(uni.showModal({title:"è®¾å¤‡ä¸æ”¯æŒ",content:"æ‚¨çš„è®¾å¤‡ä¸æ”¯æŒä¼ æ„Ÿå™¨åŠŸèƒ½ï¼Œæ— æ³•è¿›è¡Œæ¸¸æˆ",showCancel:!1,success:()=>{uni.navigateBack()}}),!1)},checkSensorStatus(){"undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission&&(this.showPermissionTip=!0)},async requestPermission(){try{if("undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission){if("granted"!==await DeviceMotionEvent.requestPermission())throw new Error("è¿åŠ¨ä¼ æ„Ÿå™¨æƒé™è¢«æ‹’ç»")}if("undefined"!=typeof DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission){if("granted"!==await DeviceOrientationEvent.requestPermission())throw new Error("æ–¹å‘ä¼ æ„Ÿå™¨æƒé™è¢«æ‹’ç»")}this.showPermissionTip=!1,uni.showToast({title:"æƒé™è·å–æˆåŠŸ",icon:"success"})}catch(e){u("error","at pages/swimming/index.vue:170","æƒé™è·å–å¤±è´¥:",e),uni.showModal({title:"æƒé™è·å–å¤±è´¥",content:"æ— æ³•è·å–ä¼ æ„Ÿå™¨æƒé™ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®",showCancel:!1})}},startGame(){this.showInstructions=!1,this.gameStarted=!0,this.countdown=3;const e=()=>{this.countdown<=0?(this.countdown=0,this.$refs.gameUI.startGame()):(this.countdown--,setTimeout(e,1e3))};setTimeout(e,1e3)},closeInstructions(){this.showInstructions=!1},openInstructions(){this.showInstructions=!0},closePermissionTip(){this.showPermissionTip=!1},handleGameStart(){this.gameStarted=!0,u("log","at pages/swimming/index.vue:220","æ¸¸æˆå¼€å§‹")},handleGameEnd(e){this.gameStarted=!1,u("log","at pages/swimming/index.vue:228","æ¸¸æˆç»“æŸ:",e),uni.showModal({title:"æ¸¸æˆç»“æŸ",content:`æœ€ç»ˆåˆ†æ•°ï¼š${e.score}\næ¸¸æ³³è·ç¦»ï¼š${Math.round(e.distance)}m\næŒ¥è‡‚æ¬¡æ•°ï¼š${e.strokeCount}`,showCancel:!1,confirmText:"å†æ¥ä¸€å±€",success:e=>{e.confirm&&this.restartGame()}}),e&&"number"==typeof e.score&&e.score>this.bestScore&&(this.bestScore=e.score,uni.setStorageSync("bestScore",this.bestScore),uni.showToast({title:"æ–°çºªå½•!",icon:"success"}))},restartGame(){this.$refs.gameUI.restartGame()}}},[["render",function(t,s,a,i,n,o){const r=e.resolveComponent("SwimmingGameUI");return e.openBlock(),e.createElementBlock("view",{class:"swimming-page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("view",{class:"header-content"},[e.createElementVNode("text",{class:"page-title"},"æ¸¸æ³³æ¸¸æˆ"),e.createElementVNode("view",{class:"header-spacer"})])]),e.createVNode(r,{ref:"gameUI",onGameStart:o.handleGameStart,onGameEnd:o.handleGameEnd},null,8,["onGameStart","onGameEnd"]),n.countdown>0&&n.gameStarted?(e.openBlock(),e.createElementBlock("view",{key:0,class:"countdown-overlay"},[e.createElementVNode("text",{class:"count-text"},e.toDisplayString(n.countdown),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"best-score-box"},[e.createElementVNode("text",{class:"best-score-text"},"æœ€ä½³åˆ†æ•°ï¼š"+e.toDisplayString(n.bestScore),1)]),n.showInstructions?(e.openBlock(),e.createElementBlock("view",{key:1,class:"instructions-modal"},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"æ¸¸æˆè¯´æ˜"),e.createElementVNode("button",{class:"close-button",onClick:s[0]||(s[0]=(...e)=>o.closeInstructions&&o.closeInstructions(...e))},"Ã—")]),e.createElementVNode("view",{class:"modal-body"},[e.createElementVNode("view",{class:"instruction-section"},[e.createElementVNode("text",{class:"section-title"},"ğŸ® æ¸¸æˆç©æ³•"),e.createElementVNode("text",{class:"instruction-text"},"â€¢ å€¾æ–œæ‰‹æœºæ§åˆ¶æ–¹å‘ï¼ˆå·¦å³/å‰åï¼‰"),e.createElementVNode("text",{class:"instruction-text"},"â€¢ è§’è‰²æŒç»­å‰è¿›ï¼Œæ–¹å‘å—å€¾æ–œä¸æ‘‡æ†å½±å“"),e.createElementVNode("text",{class:"instruction-text"},"â€¢ æ”¶é›†é‡‘å¸è·å–åˆ†æ•°ï¼Œé¿å¼€éšœç¢ç‰©")]),e.createElementVNode("view",{class:"instruction-section"},[e.createElementVNode("text",{class:"section-title"},"ğŸ“± ä¼ æ„Ÿå™¨ä¸å®‰å…¨"),e.createElementVNode("text",{class:"instruction-text"},"â€¢ éœ€è¦æ–¹å‘ä¼ æ„Ÿå™¨ï¼ˆDeviceOrientationï¼‰æƒé™"),e.createElementVNode("text",{class:"instruction-text"},"â€¢ è¯·åœ¨å®‰å…¨ç¯å¢ƒä¸‹æ¸¸ç©ï¼Œé¿å…å‰§çƒˆæ™ƒåŠ¨"),e.createElementVNode("text",{class:"instruction-text"},"â€¢ å»ºè®®åå§¿æˆ–ç«™ç«‹è½»å¾®å€¾æ–œæ“ä½œ")]),e.createElementVNode("view",{class:"instruction-section"},[e.createElementVNode("text",{class:"section-title"},"ğŸ† è§„åˆ™ä¸æ—¶é•¿"),e.createElementVNode("text",{class:"instruction-text"},"â€¢ é‡‘å¸ +1 åˆ†ï¼›æ¯è¿ç»­åƒ 3 ä¸ªé‡‘å¸ +1 å‘½ï¼ˆä¸Šé™ 5ï¼‰"),e.createElementVNode("text",{class:"instruction-text"},"â€¢ ç¢°æ’éšœç¢ç‰©ä¼šæ‰£ 1 å‘½ï¼Œå¹¶è·å¾—çŸ­æš‚æ— æ•Œ"),e.createElementVNode("text",{class:"instruction-text"},"â€¢ åˆå§‹ 3 æ¡å‘½ï¼›æ€»æ—¶é•¿ 60 ç§’")])]),e.createElementVNode("view",{class:"modal-footer"},[e.createElementVNode("button",{class:"start-game-button",onClick:s[1]||(s[1]=(...e)=>o.startGame&&o.startGame(...e))}," å¼€å§‹æ¸¸æˆ ")])])])):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"rules-fab",onClick:s[2]||(s[2]=(...e)=>o.openInstructions&&o.openInstructions(...e))},"è§„åˆ™"),n.showPermissionTip?(e.openBlock(),e.createElementBlock("view",{key:2,class:"permission-tip"},[e.createElementVNode("view",{class:"tip-content"},[e.createElementVNode("text",{class:"tip-text"},"éœ€è¦ä¼ æ„Ÿå™¨æƒé™æ‰èƒ½è¿›è¡Œæ¸¸æˆ"),e.createElementVNode("button",{class:"tip-button",onClick:s[3]||(s[3]=(...e)=>o.requestPermission&&o.requestPermission(...e))}," æˆæƒ "),e.createElementVNode("button",{class:"tip-close",onClick:s[4]||(s[4]=(...e)=>o.closePermissionTip&&o.closePermissionTip(...e))}," Ã— ")])])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-6f6add5d"]]);const f=l({data:()=>({session:null,user:null,bestScore:0,recentScore:0,totalGames:0,totalCoins:0,longestGameMs:0}),computed:{expiresDisplay(){if(!this.session)return"";const e=new Date(this.session.expiresAt),t=e=>String(e).padStart(2,"0");return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())} ${t(e.getHours())}:${t(e.getMinutes())}`},longestGameDisplay(){const e=Number(this.longestGameMs||0);if(!e||isNaN(e))return"0:00";const t=Math.round(e/1e3);return`${Math.floor(t/60)}:${String(t%60).padStart(2,"0")}`}},mounted(){this.session=n(),this.user=c();try{const e=uni.getStorageSync("bestScore");"number"==typeof e&&(this.bestScore=e);const t=uni.getStorageSync("recentScore");"number"==typeof t&&(this.recentScore=t);const s=uni.getStorageSync("totalGames");"number"==typeof s&&(this.totalGames=s);const a=uni.getStorageSync("totalCoins");"number"==typeof a&&(this.totalCoins=a);const i=uni.getStorageSync("longestGameMs");"number"==typeof i&&(this.longestGameMs=i)}catch(e){}},methods:{goLogin(){uni.reLaunch({url:"/pages/auth/login"})},doLogout(){o(),uni.reLaunch({url:"/pages/auth/login"})}}},[["render",function(t,s,a,i,n,o){return e.openBlock(),e.createElementBlock("view",{class:"my-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"title"},"æˆ‘çš„"),e.createElementVNode("text",{class:"subtitle"},"è´¦æˆ·ä¸æ•°æ®")]),n.user?(e.openBlock(),e.createElementBlock("view",{key:0,class:"card"},[e.createElementVNode("text",{class:"row"},[e.createElementVNode("text",{class:"label"},"ç”¨æˆ·åï¼š"),e.createTextVNode(e.toDisplayString(n.user.name),1)]),n.session?(e.openBlock(),e.createElementBlock("text",{key:0,class:"row"},[e.createElementVNode("text",{class:"label"},"ç™»å½•æœ‰æ•ˆæœŸï¼š"),e.createTextVNode(e.toDisplayString(o.expiresDisplay),1)])):e.createCommentVNode("",!0),n.session?(e.openBlock(),e.createElementBlock("text",{key:1,class:"row"},[e.createElementVNode("text",{class:"label"},"ä»¤ç‰Œï¼š"),e.createTextVNode(e.toDisplayString(n.session.token),1)])):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"card"},[e.createElementVNode("text",null,"æœªç™»å½•ï¼Œè¯·å‰å¾€ç™»å½•é¡µã€‚"),e.createElementVNode("button",{class:"btn",onClick:s[0]||(s[0]=(...e)=>o.goLogin&&o.goLogin(...e))},"å»ç™»å½•")])),e.createElementVNode("view",{class:"section"},[e.createElementVNode("text",{class:"sec-title"},"æ¸¸æˆæ¦‚è¦ï¼ˆç¤ºä¾‹ï¼‰"),e.createElementVNode("view",{class:"stats"},[e.createElementVNode("text",null,"æœ€è¿‘åˆ†æ•°ï¼š"+e.toDisplayString(n.recentScore),1),e.createElementVNode("text",null,"æœ€ä½³åˆ†æ•°ï¼š"+e.toDisplayString(n.bestScore),1),e.createElementVNode("text",null,"ç´¯è®¡å¯¹å±€ï¼š"+e.toDisplayString(n.totalGames),1),e.createElementVNode("text",null,"ç´¯è®¡é‡‘å¸ï¼š"+e.toDisplayString(n.totalCoins),1),e.createElementVNode("text",null,"æœ€é•¿ä¸€å±€ï¼š"+e.toDisplayString(o.longestGameDisplay),1)])]),n.user?(e.openBlock(),e.createElementBlock("view",{key:2,class:"footer"},[e.createElementVNode("button",{class:"btn danger",onClick:s[1]||(s[1]=(...e)=>o.doLogout&&o.doLogout(...e))},"é€€å‡ºç™»å½•")])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-2666b58b"]]);__definePage("pages/auth/login",h),__definePage("pages/auth/register",m),__definePage("pages/test-sensors",p),__definePage("pages/swimming/index",y),__definePage("pages/profile/my",f);const v={onLaunch(){u("log","at App.vue:4","æ¸¸æ³³æ¸¸æˆå¯åŠ¨")},onShow(){u("log","at App.vue:7","æ¸¸æ³³æ¸¸æˆæ˜¾ç¤º")},onHide(){u("log","at App.vue:10","æ¸¸æ³³æ¸¸æˆéšè—")},globalData:{gameVersion:"1.0.0"}},b={state:{gameState:{isPlaying:!1,score:0,level:1},sensorState:{isEnabled:!1,acceleration:{x:0,y:0,z:0}}},mutations:{UPDATE_GAME_STATE(e,t){e.gameState={...e.gameState,...t}},UPDATE_SENSOR_STATE(e,t){e.sensorState={...e.sensorState,...t}}},actions:{startGame({commit:e}){e("UPDATE_GAME_STATE",{isPlaying:!0,score:0})},endGame({commit:e}){e("UPDATE_GAME_STATE",{isPlaying:!1})},updateScore({commit:e},t){e("UPDATE_GAME_STATE",{score:t})},updateAcceleration({commit:e},t){e("UPDATE_SENSOR_STATE",{acceleration:t})}},getters:{isGamePlaying:e=>e.gameState.isPlaying,currentScore:e=>e.gameState.score,currentLevel:e=>e.gameState.level,accelerationData:e=>e.sensorState.acceleration}};
/*!
   * pinia v2.1.7
   * (c) 2023 Eduardo San Martin Morote
   * @license MIT
   */
let w;const S=e=>w=e,k=Symbol();function E(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var x,_;(_=x||(x={})).direct="direct",_.patchObject="patch object",_.patchFunction="patch function";const M="undefined"!=typeof window;function N(){const t=e.effectScope(!0),s=t.run((()=>e.ref({})));let a=[],i=[];const n=e.markRaw({install(e){S(n),n._a=e,e.provide(k,n),e.config.globalProperties.$pinia=n,i.forEach((e=>a.push(e))),i=[]},use(e){return this._a?a.push(e):i.push(e),this},_p:a,_a:null,_e:t,_s:new Map,state:s});return n}const V=()=>{};function D(t,s,a,i=V){t.push(s);const n=()=>{const e=t.indexOf(s);e>-1&&(t.splice(e,1),i())};return!a&&e.getCurrentScope()&&e.onScopeDispose(n),n}function G(e,...t){e.slice().forEach((e=>{e(...t)}))}const C=e=>e();function P(t,s){t instanceof Map&&s instanceof Map&&s.forEach(((e,s)=>t.set(s,e))),t instanceof Set&&s instanceof Set&&s.forEach(t.add,t);for(const a in s){if(!s.hasOwnProperty(a))continue;const i=s[a],n=t[a];E(n)&&E(i)&&t.hasOwnProperty(a)&&!e.isRef(i)&&!e.isReactive(i)?t[a]=P(n,i):t[a]=i}return t}const T=Symbol();const{assign:A}=Object;function R(t,s,a={},i,n,o){let r;const c=A({actions:{}},a),l={deep:!0};let h,m,u,d=[],p=[];const g=i.state.value[t];let y;function f(s){let a;h=m=!1,"function"==typeof s?(s(i.state.value[t]),a={type:x.patchFunction,storeId:t,events:u}):(P(i.state.value[t],s),a={type:x.patchObject,payload:s,storeId:t,events:u});const n=y=Symbol();e.nextTick().then((()=>{y===n&&(h=!0)})),m=!0,G(d,a,i.state.value[t])}o||g||(i.state.value[t]={}),e.ref({});const v=o?function(){const{state:e}=a,t=e?e():{};this.$patch((e=>{A(e,t)}))}:V;function b(e,s){return function(){S(i);const a=Array.from(arguments),n=[],o=[];function r(e){n.push(e)}function c(e){o.push(e)}let l;G(p,{args:a,name:e,store:k,after:r,onError:c});try{l=s.apply(this&&this.$id===t?this:k,a)}catch(h){throw G(o,h),h}return l instanceof Promise?l.then((e=>(G(n,e),e))).catch((e=>(G(o,e),Promise.reject(e)))):(G(n,l),l)}}const w={_p:i,$id:t,$onAction:D.bind(null,p),$patch:f,$reset:v,$subscribe(s,a={}){const n=D(d,s,a.detached,(()=>o())),o=r.run((()=>e.watch((()=>i.state.value[t]),(e=>{("sync"===a.flush?m:h)&&s({storeId:t,type:x.direct,events:u},e)}),A({},l,a))));return n},$dispose:function(){r.stop(),d=[],p=[],i._s.delete(t)}},k=e.reactive(w);i._s.set(t,k);const _=(i._a&&i._a.runWithContext||C)((()=>i._e.run((()=>(r=e.effectScope()).run(s)))));for(const S in _){const s=_[S];if(e.isRef(s)&&(N=s,!e.isRef(N)||!N.effect)||e.isReactive(s))o||(!g||E(M=s)&&M.hasOwnProperty(T)||(e.isRef(s)?s.value=g[S]:P(s,g[S])),i.state.value[t][S]=s);else if("function"==typeof s){const e=b(S,s);_[S]=e,c.actions[S]=s}}var M,N;return A(k,_),A(e.toRaw(k),_),Object.defineProperty(k,"$state",{get:()=>i.state.value[t],set:e=>{f((t=>{A(t,e)}))}}),i._p.forEach((e=>{A(k,r.run((()=>e({store:k,app:i._a,pinia:i,options:c}))))})),g&&o&&a.hydrate&&a.hydrate(k.$state,g),h=!0,m=!0,k}let O="Store";function L(e,t){return Array.isArray(t)?t.reduce(((t,s)=>(t[s]=function(){return e(this.$pinia)[s]},t)),{}):Object.keys(t).reduce(((s,a)=>(s[a]=function(){const s=e(this.$pinia),i=t[a];return"function"==typeof i?i.call(this,s):s[i]},s)),{})}const I=L;const B=Object.freeze(Object.defineProperty({__proto__:null,get MutationType(){return x},PiniaVuePlugin:function(e){e.mixin({beforeCreate(){const e=this.$options;if(e.pinia){const t=e.pinia;if(!this._provided){const e={};Object.defineProperty(this,"_provided",{get:()=>e,set:t=>Object.assign(e,t)})}this._provided[k]=t,this.$pinia||(this.$pinia=t),t._a=this,M&&S(t)}else!this.$pinia&&e.parent&&e.parent.$pinia&&(this.$pinia=e.parent.$pinia)},destroyed(){delete this._pStores}})},acceptHMRUpdate:function(e,t){return()=>{}},createPinia:N,defineStore:function(t,s,a){let i,n;const o="function"==typeof s;function r(t,a){const r=e.hasInjectionContext();(t=t||(r?e.inject(k,null):null))&&S(t),(t=w)._s.has(i)||(o?R(i,s,n,t):function(t,s,a,i){const{state:n,actions:o,getters:r}=s,c=a.state.value[t];let l;l=R(t,(function(){c||(a.state.value[t]=n?n():{});const s=e.toRefs(a.state.value[t]);return A(s,o,Object.keys(r||{}).reduce(((s,i)=>(s[i]=e.markRaw(e.computed((()=>{S(a);const e=a._s.get(t);return r[i].call(e,e)}))),s)),{}))}),s,a,0,!0)}(i,n,t));return t._s.get(i)}return"string"==typeof t?(i=t,n=o?a:s):(n=t,i=t.id),r.$id=i,r},getActivePinia:()=>e.hasInjectionContext()&&e.inject(k)||w,mapActions:function(e,t){return Array.isArray(t)?t.reduce(((t,s)=>(t[s]=function(...t){return e(this.$pinia)[s](...t)},t)),{}):Object.keys(t).reduce(((s,a)=>(s[a]=function(...s){return e(this.$pinia)[t[a]](...s)},s)),{})},mapGetters:I,mapState:L,mapStores:function(...e){return e.reduce(((e,t)=>(e[t.$id+O]=function(){return t(this.$pinia)},e)),{})},mapWritableState:function(e,t){return Array.isArray(t)?t.reduce(((t,s)=>(t[s]={get(){return e(this.$pinia)[s]},set(t){return e(this.$pinia)[s]=t}},t)),{}):Object.keys(t).reduce(((s,a)=>(s[a]={get(){return e(this.$pinia)[t[a]]},set(s){return e(this.$pinia)[t[a]]=s}},s)),{})},setActivePinia:S,setMapStoreSuffix:function(e){O=e},skipHydrate:function(e){return Object.defineProperty(e,T,{})},storeToRefs:function(t){{t=e.toRaw(t);const s={};for(const a in t){const i=t[a];(e.isRef(i)||e.isReactive(i))&&(s[a]=e.toRef(t,a))}return s}}},Symbol.toStringTag,{value:"Module"}));function z(){return"undefined"!=typeof navigator&&"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}}const j="function"==typeof Proxy;class ${constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const s={};if(e.settings)for(const o in e.settings){const t=e.settings[o];s[o]=t.defaultValue}const a=`__vue-devtools-plugin-settings__${e.id}`;let i={...s};try{const e=localStorage.getItem(a),t=JSON.parse(e);Object.assign(i,t)}catch(n){}this.fallbacks={getSettings:()=>i,setSettings(e){try{localStorage.setItem(a,JSON.stringify(e))}catch(n){}i=e}},t.on("plugin:settings:set",((e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)})),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise((s=>{this.targetQueue.push({method:t,args:e,resolve:s})}))})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function F(e,t){const s=z(),a=z().__VUE_DEVTOOLS_GLOBAL_HOOK__,i=j&&e.enableEarlyProxy;if(!a||!s.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&i){const n=i?new $(e,a):null;(s.__VUE_DEVTOOLS_PLUGINS__=s.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:e,setupFn:t,proxy:n}),n&&t(n.proxiedTarget)}else a.emit("devtools-plugin:setup",e,t)}
/*!
   * vuex v4.1.0
   * (c) 2022 Evan You
   * @license MIT
   */var U="store";function q(e,t){if(void 0===t&&(t=[]),null===e||"object"!=typeof e)return e;var s,a=(s=function(t){return t.original===e},t.filter(s)[0]);if(a)return a.copy;var i=Array.isArray(e)?[]:{};return t.push({original:e,copy:i}),Object.keys(e).forEach((function(s){i[s]=q(e[s],t)})),i}function H(e,t){Object.keys(e).forEach((function(s){return t(e[s],s)}))}function W(e){return null!==e&&"object"==typeof e}function Y(e,t,s){return t.indexOf(e)<0&&(s&&s.prepend?t.unshift(e):t.push(e)),function(){var s=t.indexOf(e);s>-1&&t.splice(s,1)}}function X(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var s=e.state;Q(e,s,[],e._modules.root,!0),Z(e,s,t)}function Z(t,s,a){var i=t._state,n=t._scope;t.getters={},t._makeLocalGettersCache=Object.create(null);var o=t._wrappedGetters,r={},c={},l=e.effectScope(!0);l.run((function(){H(o,(function(s,a){r[a]=function(e,t){return function(){return e(t)}}(s,t),c[a]=e.computed((function(){return r[a]()})),Object.defineProperty(t.getters,a,{get:function(){return c[a].value},enumerable:!0})}))})),t._state=e.reactive({data:s}),t._scope=l,t.strict&&function(t){e.watch((function(){return t._state.data}),(function(){}),{deep:!0,flush:"sync"})}(t),i&&a&&t._withCommit((function(){i.data=null})),n&&n.stop()}function Q(e,t,s,a,i){var n=!s.length,o=e._modules.getNamespace(s);if(a.namespaced&&(e._modulesNamespaceMap[o],e._modulesNamespaceMap[o]=a),!n&&!i){var r=K(t,s.slice(0,-1)),c=s[s.length-1];e._withCommit((function(){r[c]=a.state}))}var l=a.context=function(e,t,s){var a=""===t,i={dispatch:a?e.dispatch:function(s,a,i){var n=ee(s,a,i),o=n.payload,r=n.options,c=n.type;return r&&r.root||(c=t+c),e.dispatch(c,o)},commit:a?e.commit:function(s,a,i){var n=ee(s,a,i),o=n.payload,r=n.options,c=n.type;r&&r.root||(c=t+c),e.commit(c,o,r)}};return Object.defineProperties(i,{getters:{get:a?function(){return e.getters}:function(){return J(e,t)}},state:{get:function(){return K(e.state,s)}}}),i}(e,o,s);a.forEachMutation((function(t,s){!function(e,t,s,a){(e._mutations[t]||(e._mutations[t]=[])).push((function(t){s.call(e,a.state,t)}))}(e,o+s,t,l)})),a.forEachAction((function(t,s){var a=t.root?s:o+s,i=t.handler||t;!function(e,t,s,a){(e._actions[t]||(e._actions[t]=[])).push((function(t){var i,n=s.call(e,{dispatch:a.dispatch,commit:a.commit,getters:a.getters,state:a.state,rootGetters:e.getters,rootState:e.state},t);return(i=n)&&"function"==typeof i.then||(n=Promise.resolve(n)),e._devtoolHook?n.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):n}))}(e,a,i,l)})),a.forEachGetter((function(t,s){!function(e,t,s,a){if(e._wrappedGetters[t])return;e._wrappedGetters[t]=function(e){return s(a.state,a.getters,e.state,e.getters)}}(e,o+s,t,l)})),a.forEachChild((function(a,n){Q(e,t,s.concat(n),a,i)}))}function J(e,t){if(!e._makeLocalGettersCache[t]){var s={},a=t.length;Object.keys(e.getters).forEach((function(i){if(i.slice(0,a)===t){var n=i.slice(a);Object.defineProperty(s,n,{get:function(){return e.getters[i]},enumerable:!0})}})),e._makeLocalGettersCache[t]=s}return e._makeLocalGettersCache[t]}function K(e,t){return t.reduce((function(e,t){return e[t]}),e)}function ee(e,t,s){return W(e)&&e.type&&(s=t,t=e,e=e.type),{type:e,payload:t,options:s}}var te="vuex:mutations",se="vuex:actions",ae="vuex",ie=0;function ne(e,t){F({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:["vuex bindings"]},(function(s){s.addTimelineLayer({id:te,label:"Vuex Mutations",color:oe}),s.addTimelineLayer({id:se,label:"Vuex Actions",color:oe}),s.addInspector({id:ae,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),s.on.getInspectorTree((function(s){if(s.app===e&&s.inspectorId===ae)if(s.filter){var a=[];he(a,t._modules.root,s.filter,""),s.rootNodes=a}else s.rootNodes=[le(t._modules.root,"")]})),s.on.getInspectorState((function(s){if(s.app===e&&s.inspectorId===ae){var a=s.nodeId;J(t,a),s.state=function(e,t,s){t="root"===s?t:t[s];var a=Object.keys(t),i={state:Object.keys(e.state).map((function(t){return{key:t,editable:!0,value:e.state[t]}}))};if(a.length){var n=function(e){var t={};return Object.keys(e).forEach((function(s){var a=s.split("/");if(a.length>1){var i=t,n=a.pop();a.forEach((function(e){i[e]||(i[e]={_custom:{value:{},display:e,tooltip:"Module",abstract:!0}}),i=i[e]._custom.value})),i[n]=me((function(){return e[s]}))}else t[s]=me((function(){return e[s]}))})),t}(t);i.getters=Object.keys(n).map((function(e){return{key:e.endsWith("/")?ce(e):e,editable:!1,value:me((function(){return n[e]}))}}))}return i}((i=t._modules,(o=(n=a).split("/").filter((function(e){return e}))).reduce((function(e,t,s){var a=e[t];if(!a)throw new Error('Missing module "'+t+'" for path "'+n+'".');return s===o.length-1?a:a._children}),"root"===n?i:i.root._children)),"root"===a?t.getters:t._makeLocalGettersCache,a)}var i,n,o})),s.on.editInspectorState((function(s){if(s.app===e&&s.inspectorId===ae){var a=s.nodeId,i=s.path;"root"!==a&&(i=a.split("/").filter(Boolean).concat(i)),t._withCommit((function(){s.set(t._state.data,i,s.state.value)}))}})),t.subscribe((function(e,t){var a={};e.payload&&(a.payload=e.payload),a.state=t,s.notifyComponentUpdate(),s.sendInspectorTree(ae),s.sendInspectorState(ae),s.addTimelineEvent({layerId:te,event:{time:Date.now(),title:e.type,data:a}})})),t.subscribeAction({before:function(e,t){var a={};e.payload&&(a.payload=e.payload),e._id=ie++,e._time=Date.now(),a.state=t,s.addTimelineEvent({layerId:se,event:{time:e._time,title:e.type,groupId:e._id,subtitle:"start",data:a}})},after:function(e,t){var a={},i=Date.now()-e._time;a.duration={_custom:{type:"duration",display:i+"ms",tooltip:"Action duration",value:i}},e.payload&&(a.payload=e.payload),a.state=t,s.addTimelineEvent({layerId:se,event:{time:Date.now(),title:e.type,groupId:e._id,subtitle:"end",data:a}})}})}))}var oe=8702998,re={label:"namespaced",textColor:16777215,backgroundColor:6710886};function ce(e){return e&&"root"!==e?e.split("/").slice(-2,-1)[0]:"Root"}function le(e,t){return{id:t||"root",label:ce(t),tags:e.namespaced?[re]:[],children:Object.keys(e._children).map((function(s){return le(e._children[s],t+s+"/")}))}}function he(e,t,s,a){a.includes(s)&&e.push({id:a||"root",label:a.endsWith("/")?a.slice(0,a.length-1):a||"Root",tags:t.namespaced?[re]:[]}),Object.keys(t._children).forEach((function(i){he(e,t._children[i],s,a+i+"/")}))}function me(e){try{return e()}catch(t){return t}}var ue=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var s=e.state;this.state=("function"==typeof s?s():s)||{}},de={namespaced:{configurable:!0}};de.namespaced.get=function(){return!!this._rawModule.namespaced},ue.prototype.addChild=function(e,t){this._children[e]=t},ue.prototype.removeChild=function(e){delete this._children[e]},ue.prototype.getChild=function(e){return this._children[e]},ue.prototype.hasChild=function(e){return e in this._children},ue.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},ue.prototype.forEachChild=function(e){H(this._children,e)},ue.prototype.forEachGetter=function(e){this._rawModule.getters&&H(this._rawModule.getters,e)},ue.prototype.forEachAction=function(e){this._rawModule.actions&&H(this._rawModule.actions,e)},ue.prototype.forEachMutation=function(e){this._rawModule.mutations&&H(this._rawModule.mutations,e)},Object.defineProperties(ue.prototype,de);var pe=function(e){this.register([],e,!1)};function ge(e,t,s){if(t.update(s),s.modules)for(var a in s.modules){if(!t.getChild(a))return;ge(e.concat(a),t.getChild(a),s.modules[a])}}pe.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},pe.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,s){return e+((t=t.getChild(s)).namespaced?s+"/":"")}),"")},pe.prototype.update=function(e){ge([],this.root,e)},pe.prototype.register=function(e,t,s){var a=this;void 0===s&&(s=!0);var i=new ue(t,s);0===e.length?this.root=i:this.get(e.slice(0,-1)).addChild(e[e.length-1],i);t.modules&&H(t.modules,(function(t,i){a.register(e.concat(i),t,s)}))},pe.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),s=e[e.length-1],a=t.getChild(s);a&&a.runtime&&t.removeChild(s)},pe.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),s=e[e.length-1];return!!t&&t.hasChild(s)};var ye=function(e){var t=this;void 0===e&&(e={});var s=e.plugins;void 0===s&&(s=[]);var a=e.strict;void 0===a&&(a=!1);var i=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new pe(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=i;var n=this,o=this.dispatch,r=this.commit;this.dispatch=function(e,t){return o.call(n,e,t)},this.commit=function(e,t,s){return r.call(n,e,t,s)},this.strict=a;var c=this._modules.root.state;Q(this,c,[],this._modules.root),Z(this,c),s.forEach((function(e){return e(t)}))},fe={state:{configurable:!0}};ye.prototype.install=function(e,t){e.provide(t||U,this),e.config.globalProperties.$store=this,void 0!==this._devtools&&this._devtools&&ne(e,this)},fe.state.get=function(){return this._state.data},fe.state.set=function(e){},ye.prototype.commit=function(e,t,s){var a=this,i=ee(e,t,s),n=i.type,o=i.payload,r={type:n,payload:o},c=this._mutations[n];c&&(this._withCommit((function(){c.forEach((function(e){e(o)}))})),this._subscribers.slice().forEach((function(e){return e(r,a.state)})))},ye.prototype.dispatch=function(e,t){var s=this,a=ee(e,t),i=a.type,n=a.payload,o={type:i,payload:n},r=this._actions[i];if(r){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(o,s.state)}))}catch(l){}var c=r.length>1?Promise.all(r.map((function(e){return e(n)}))):r[0](n);return new Promise((function(e,t){c.then((function(t){try{s._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(o,s.state)}))}catch(l){}e(t)}),(function(e){try{s._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(o,s.state,e)}))}catch(l){}t(e)}))}))}},ye.prototype.subscribe=function(e,t){return Y(e,this._subscribers,t)},ye.prototype.subscribeAction=function(e,t){return Y("function"==typeof e?{before:e}:e,this._actionSubscribers,t)},ye.prototype.watch=function(t,s,a){var i=this;return e.watch((function(){return t(i.state,i.getters)}),s,Object.assign({},a))},ye.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._state.data=e}))},ye.prototype.registerModule=function(e,t,s){void 0===s&&(s={}),"string"==typeof e&&(e=[e]),this._modules.register(e,t),Q(this,this.state,e,this._modules.get(e),s.preserveState),Z(this,this.state)},ye.prototype.unregisterModule=function(e){var t=this;"string"==typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){delete K(t.state,e.slice(0,-1))[e[e.length-1]]})),X(this)},ye.prototype.hasModule=function(e){return"string"==typeof e&&(e=[e]),this._modules.isRegistered(e)},ye.prototype.hotUpdate=function(e){this._modules.update(e),X(this,!0)},ye.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(ye.prototype,fe);var ve=Ee((function(e,t){var s={};return ke(t).forEach((function(t){var a=t.key,i=t.val;s[a]=function(){var t=this.$store.state,s=this.$store.getters;if(e){var a=xe(this.$store,"mapState",e);if(!a)return;t=a.context.state,s=a.context.getters}return"function"==typeof i?i.call(this,t,s):t[i]},s[a].vuex=!0})),s})),be=Ee((function(e,t){var s={};return ke(t).forEach((function(t){var a=t.key,i=t.val;s[a]=function(){for(var t=[],s=arguments.length;s--;)t[s]=arguments[s];var a=this.$store.commit;if(e){var n=xe(this.$store,"mapMutations",e);if(!n)return;a=n.context.commit}return"function"==typeof i?i.apply(this,[a].concat(t)):a.apply(this.$store,[i].concat(t))}})),s})),we=Ee((function(e,t){var s={};return ke(t).forEach((function(t){var a=t.key,i=t.val;i=e+i,s[a]=function(){if(!e||xe(this.$store,"mapGetters",e))return this.$store.getters[i]},s[a].vuex=!0})),s})),Se=Ee((function(e,t){var s={};return ke(t).forEach((function(t){var a=t.key,i=t.val;s[a]=function(){for(var t=[],s=arguments.length;s--;)t[s]=arguments[s];var a=this.$store.dispatch;if(e){var n=xe(this.$store,"mapActions",e);if(!n)return;a=n.context.dispatch}return"function"==typeof i?i.apply(this,[a].concat(t)):a.apply(this.$store,[i].concat(t))}})),s}));function ke(e){return function(e){return Array.isArray(e)||W(e)}(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function Ee(e){return function(t,s){return"string"!=typeof t?(s=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,s)}}function xe(e,t,s){return e._modulesNamespaceMap[s]}function _e(e,t,s){var a=s?e.groupCollapsed:e.group;try{a.call(e,t)}catch(i){e.log(t)}}function Me(e){try{e.groupEnd()}catch(t){e.log("â€”â€” log end â€”â€”")}}function Ne(){var e=new Date;return" @ "+Ve(e.getHours(),2)+":"+Ve(e.getMinutes(),2)+":"+Ve(e.getSeconds(),2)+"."+Ve(e.getMilliseconds(),3)}function Ve(e,t){return s="0",a=t-e.toString().length,new Array(a+1).join(s)+e;var s,a}var De={version:"4.1.0",Store:ye,storeKey:U,createStore:function(e){return new ye(e)},useStore:function(t){return void 0===t&&(t=null),e.inject(null!==t?t:U)},mapState:ve,mapMutations:be,mapGetters:we,mapActions:Se,createNamespacedHelpers:function(e){return{mapState:ve.bind(null,e),mapGetters:we.bind(null,e),mapMutations:be.bind(null,e),mapActions:Se.bind(null,e)}},createLogger:function(e){void 0===e&&(e={});var t=e.collapsed;void 0===t&&(t=!0);var s=e.filter;void 0===s&&(s=function(e,t,s){return!0});var a=e.transformer;void 0===a&&(a=function(e){return e});var i=e.mutationTransformer;void 0===i&&(i=function(e){return e});var n=e.actionFilter;void 0===n&&(n=function(e,t){return!0});var o=e.actionTransformer;void 0===o&&(o=function(e){return e});var r=e.logMutations;void 0===r&&(r=!0);var c=e.logActions;void 0===c&&(c=!0);var l=e.logger;return void 0===l&&(l=console),function(e){var h=q(e.state);void 0!==l&&(r&&e.subscribe((function(e,n){var o=q(n);if(s(e,h,o)){var r=Ne(),c=i(e),m="mutation "+e.type+r;_e(l,m,t),l.log("%c prev state","color: #9E9E9E; font-weight: bold",a(h)),l.log("%c mutation","color: #03A9F4; font-weight: bold",c),l.log("%c next state","color: #4CAF50; font-weight: bold",a(o)),Me(l)}h=o})),c&&e.subscribeAction((function(e,s){if(n(e,s)){var a=Ne(),i=o(e),r="action "+e.type+a;_e(l,r,t),l.log("%c action","color: #03A9F4; font-weight: bold",i),Me(l)}})))}}};const{app:Ge,Vuex:Ce,Pinia:Pe}=function(){const t=e.createVueApp(v);return t.use(N()),t.config.globalProperties.$store=b,t.config.globalProperties.$adpid="1111111111",t.config.globalProperties.$backgroundAudioData={playing:!1,playTime:0,formatedPlayTime:"00:00:00"},{app:t,Vuex:De,Pinia:B}}();uni.Vuex=Ce,uni.Pinia=Pe,Ge.provide("__globalStyles",__uniConfig.styles),Ge._component.mpType="app",Ge._component.render=()=>{},Ge.mount("#app")}(Vue);
